pipeline{

	agent any

	environment{
			DOCKERHUB_CREDENTIALS=credentials('dockerhub_credential_name_on_jenkins')
		}

	stages{
		stages('Build') {

			steps {
				sh 'docker build -t docker_repository_name/app_image_name:tag .'
			      }

			}


		stages('Login') {

                        steps {
                                sh ' echo $DOCKERHUB_CREDENTIALS_PSW | docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'
                              }

                        }


		stages('Push') {

                        steps {
                                sh 'docker push docker_repository_name/app_image_name:tag'
                              }

                        }
			
		}

	post {
		always {
			sh 'docker logout'
		}
	}

}
